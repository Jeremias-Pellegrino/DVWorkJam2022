[gd_scene load_steps=12 format=2]

[ext_resource path="res://png/fondo.png" type="Texture" id=1]
[ext_resource path="res://Margarete/Margarete.tscn" type="PackedScene" id=2]
[ext_resource path="res://png/muebles/mesa.png" type="Texture" id=3]
[ext_resource path="res://png/muebles/silla.png" type="Texture" id=4]
[ext_resource path="res://Mouse/Mouse.tscn" type="PackedScene" id=5]
[ext_resource path="res://Main.gd" type="Script" id=6]
[ext_resource path="res://png/muebles/cama.png" type="Texture" id=7]
[ext_resource path="res://ClickableObject/ClickableObject.tscn" type="PackedScene" id=8]
[ext_resource path="res://png/muebles/caja fuerte.png" type="Texture" id=9]

[sub_resource type="Shader" id=1]
code = "shader_type canvas_item;
render_mode unshaded;

uniform bool Smooth = true;
uniform float width : hint_range(0.0, 64) = 4.0;
uniform vec4 outline_color : hint_color = vec4(100.0, 0.0, 70.0, 0.7);
uniform int pixel_size : hint_range(1, 10) = 4;
uniform float width_speed :hint_range(0.1, 10) = 4;

void fragment()
{
    float _width = width + ((sin(TIME*width_speed) + 1f) -2f) * 10f;
    vec2 unit = (1.0/float(pixel_size) ) / vec2(textureSize(TEXTURE, 0));
    vec4 pixel_color = texture(TEXTURE, UV);
    if (pixel_color.a == 0.0) {
        pixel_color = outline_color;
        pixel_color.a = 0.0;
        for (float x = -ceil(_width); x <= ceil(_width); x++) {
            for (float y = -ceil(_width); y <= ceil(_width); y++) {
                if (texture(TEXTURE, UV + vec2(x*unit.x, y*unit.y)).a == 0.0 || (x==0.0 && y==0.0)) {
                    continue;
                }
                if (Smooth) {
                    pixel_color.a += outline_color.a / (pow(x,2)+pow(y,2)) * (1.0-pow(2.0, -_width));
                    if (pixel_color.a > 1.0) {
                        pixel_color.a = 1.0;
                    }
                } else {
                    pixel_color.a = outline_color.a;
                    return
                }
            }
        }
    }
    COLOR = pixel_color;
}"

[sub_resource type="ShaderMaterial" id=2]
render_priority = 1
shader = SubResource( 1 )
shader_param/Smooth = true
shader_param/width = 21.333
shader_param/outline_color = Color( 100, 0, 70, 0.7 )
shader_param/pixel_size = 10
shader_param/width_speed = 2.597

[node name="Control" type="Control"]
margin_right = 1021.0
margin_bottom = 600.0
script = ExtResource( 6 )

[node name="PanelContainer" type="PanelContainer" parent="."]
anchor_right = 1.0
anchor_bottom = 1.0
__meta__ = {
"_edit_use_anchors_": true
}

[node name="Panel" type="Panel" parent="PanelContainer"]
margin_left = 7.0
margin_top = 7.0
margin_right = 1014.0
margin_bottom = 593.0

[node name="Fondo" type="TextureRect" parent="PanelContainer/Panel"]
anchor_right = 1.0
anchor_bottom = 1.0
texture = ExtResource( 1 )
expand = true

[node name="Silla" type="TextureRect" parent="PanelContainer/Panel"]
margin_left = 255.0
margin_top = 310.0
margin_right = 340.0
margin_bottom = 405.0
texture = ExtResource( 4 )
expand = true

[node name="Mesa" type="TextureRect" parent="PanelContainer/Panel"]
margin_left = 527.0
margin_top = 256.0
margin_right = 717.0
margin_bottom = 381.0
texture = ExtResource( 3 )
expand = true

[node name="TextureButton" type="TextureButton" parent="PanelContainer/Panel"]
anchor_left = 0.311
anchor_top = 0.388
anchor_right = 0.456
anchor_bottom = 0.543
margin_left = 569.823
margin_top = 249.632
margin_right = 526.808
margin_bottom = 241.802
texture_normal = ExtResource( 9 )
texture_hover = ExtResource( 4 )
expand = true

[node name="CajaFuerte" type="TextureRect" parent="PanelContainer/Panel"]
visible = false
margin_left = 895.0
margin_top = 474.0
margin_right = 991.0
margin_bottom = 575.0
texture = ExtResource( 9 )
expand = true

[node name="Margarete" parent="." instance=ExtResource( 2 )]
position = Vector2( 247, 453 )
z_index = 1

[node name="Mouse" parent="." instance=ExtResource( 5 )]
z_index = 2
z_as_relative = false

[node name="Clickable" parent="." instance=ExtResource( 8 )]

[node name="Sprite" type="Sprite" parent="."]
material = SubResource( 2 )
position = Vector2( 762, 440 )
scale = Vector2( 1.5, 1.5 )
texture = ExtResource( 7 )
